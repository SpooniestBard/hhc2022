"use strict";(self.webpackChunkhhc_2022=self.webpackChunkhhc_2022||[]).push([[894],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},h=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),c=p(n),d=r,m=c["".concat(s,".").concat(d)]||c[d]||g[d]||i;return n?a.createElement(m,o(o({ref:t},h),{},{components:n})):a.createElement(m,o({ref:t},h))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6705:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:7,hide_table_of_contents:!0},o="Glamtariel's Fountain",l={unversionedId:"hhc2022/web_ring/glamtariels_fountain",id:"hhc2022/web_ring/glamtariels_fountain",title:"Glamtariel's Fountain",description:"Background",source:"@site/docs/hhc2022/web_ring/glamtariels_fountain.md",sourceDirName:"hhc2022/web_ring",slug:"/hhc2022/web_ring/glamtariels_fountain",permalink:"/docs/hhc2022/web_ring/glamtariels_fountain",draft:!1,tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7,hide_table_of_contents:!0},sidebar:"tutorialSidebar",previous:{title:"Open Boria Mine Door",permalink:"/docs/hhc2022/web_ring/boria_mine_door"},next:{title:"The Cloud Ring",permalink:"/docs/hhc2022/cloud_ring/"}},s={},p=[{value:"Background",id:"background",level:3},{value:"Challenge",id:"challenge",level:3},{value:"Hints from Glamtariel",id:"hints-from-glamtariel",level:4},{value:"Solution",id:"solution",level:4}],h={toc:p};function c(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,a.Z)({},h,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"glamtariels-fountain"},"Glamtariel's Fountain"),(0,r.kt)("h3",{id:"background"},"Background"),(0,r.kt)("p",null,"Passing through the Boria Mine door, we're brought face to face with ",(0,r.kt)("a",{parentName:"p",href:"https://glamtarielsfountain.com"},"Glamtariel and her sentient fountain"),". Our challenge is to discover something that Glamtariel has never revealed. Is she holding the Web Ring that we're seeking?"),(0,r.kt)("h3",{id:"challenge"},"Challenge"),(0,r.kt)("admonition",{title:"Question",type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Stare into Glamtariel's fountain and see if you can find the ring! What is the filename of the ring she presents you? Talk to Hal Tandybuck in the Web Ring for hints.")),(0,r.kt)("h4",{id:"hints-from-glamtariel"},"Hints from Glamtariel"),(0,r.kt)("p",null,"According to Hal Tandybuck, Glamtariel will provide us with  hints by (somehow) speaking to us in upper case letters. During our time speaking to her, she gives us the following hints: ",(0,r.kt)("inlineCode",{parentName:"p"},"TAMPER, PATH, TYPE, RINGLIST, SIMPLE, APP")),(0,r.kt)("h4",{id:"solution"},"Solution"),(0,r.kt)("p",null,"There are three phases to our interaction with Glamtariel, broken up by the objects that we are able to offer her. By picking up objects and presenting them to either the fountain or Glamtariel, the recipient will give us"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"First phase of interaction with Glamtariel",src:n(8184).Z,width:"1191",height:"830"})),(0,r.kt)("p",null,"By giving Glamtariel and the fountain both the elf and santa objects, we can move on to phase two:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Second phase of interaction with Glamtariel",src:n(168).Z,width:"1222",height:"823"})),(0,r.kt)("p",null,"By giving the fountain and Glamtariel all of these objects (and clicking away a spooky eye along the way), we can advance to the final phase:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Third phase of interaction with Glamtariel",src:n(2205).Z,width:"1110",height:"833"})),(0,r.kt)("p",null,"Now that we're here, we're able to coax secrets out of Glamtariel. Presenting her with the grey ring has her mention a ",(0,r.kt)("strong",{parentName:"p"},"RINGLIST")," that she makes us promise not to tell anyone about. Dragging the red ring to the fountain makes it mention that Glamtariel can speak in another ",(0,r.kt)("strong",{parentName:"p"},"TYPE")," of language. Unfortunately, we've now exhausted all of the useful information either party will give us through item interactions. At this point, we decided to try asking in a different way by taking a peek at the web traffic that we were sending Glamtariel:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Web request to Glamtariel",src:n(903).Z,width:"753",height:"533"})),(0,r.kt)("p",null,"It looks like the data is sent in a simple JSON format. Since ",(0,r.kt)("inlineCode",{parentName:"p"},"reqType")," is one of the parameters, Glamtariel's hint of \"",(0,r.kt)("strong",{parentName:"p"},"TYPE"),'", and the ',(0,r.kt)("a",{parentName:"p",href:"https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing"},"XXE")," hint we received from Hal Tandybuck, implies that we should try to format our request as XML and see what happens:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Web request as XML!",src:n(8085).Z,width:"1591",height:"663"})),(0,r.kt)("p",null,"This request works! Glamtariel is clearly well-learned if she can speak such an arcane language. Now that we can ask in XML, we'll try to find that ringlist file that Glamtariel mentioned earlier."),(0,r.kt)("p",null,"Trying a few strings in the ",(0,r.kt)("inlineCode",{parentName:"p"},"imgDrop")," field such as ",(0,r.kt)("inlineCode",{parentName:"p"},"ringlist"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"ringlist.xml"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"RINGLIST")," don't seem to have any effect - neither the fountain nor Glamtariel have any idea what we're talking about. At this point, we'll try an XXE for ",(0,r.kt)("inlineCode",{parentName:"p"},"ringlist.txt")," (",(0,r.kt)("inlineCode",{parentName:"p"},".txt")," since the fountain hints that the list is stored in a ",(0,r.kt)("strong",{parentName:"p"},"SIMPLE")," format). We send the following as our request (also using the ",(0,r.kt)("inlineCode",{parentName:"p"},"/app")," directory since we need to browse from the filesystem's root and ",(0,r.kt)("strong",{parentName:"p"},"APP")," was provided as a hint earlier):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding"UTF-8" ?>\n<!DOCTYPE replace [<!ENTITY xxe SYSTEM\n"file:///app/static/images/ringlist.txt" >]>\n    <root>\n        <imgDrop>&xxe;</imgDrop>\n        <reqType>xml</reqType>\n        <who>princess</who>\n    </root>\n')),(0,r.kt)("p",null,"And this works! In Glamtariel's response, we're given a reference to an image at ",(0,r.kt)("inlineCode",{parentName:"p"},"static/images/pholder-morethantopsupersecret63842.png"),". Let's try going there and seeing what it is:"),(0,r.kt)("img",{src:n(1638).Z,style:{width:"300px"}}),(0,r.kt)("p",null,'The image shows us a folder labeled "x_phial_pholder_2022" which seems to contain two other ring files. Assuming this is indicative of the files/folder structure stored on this webserver, let\'s try our XXE again inside this folder with ',(0,r.kt)("inlineCode",{parentName:"p"},"bluering.txt"),":"),(0,r.kt)("img",{src:n(8818).Z,style:{width:"1000px"}}),(0,r.kt)("p",null,"That's interesting: it looks like this is the same speech Glamtariel gives us when we manually drop this ring on her in a browser. Although we didn't see it in the folder, one of the rings that Glamtariel presented us with earlier was silver. Let's try that next:"),(0,r.kt)("img",{src:n(7055).Z,style:{width:"1000px"}}),(0,r.kt)("p",null,"When we ask about the silver ring, we're also provided with an image of Glamtariel's red ring, which has seemingly been defiled. Looking closer at it reveals an etched secret:"),(0,r.kt)("img",{src:n(6143).Z,style:{width:"300px"}}),(0,r.kt)("p",null,"To prevent you from turning your head upside-down, the text on the red ring is ",(0,r.kt)("inlineCode",{parentName:"p"},"goldring_to_be_deleted.txt"),". With the end almost in sight, we ask Glamtariel about the golden ring:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE replace [<!ENTITY xxe SYSTEM "file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt" >]>\n    <root>\n      <imgDrop>&xxe;</imgDrop>\n      <who>princess</who>\n      <reqType>xml</reqType>\n    </root>\n')),(0,r.kt)("p",null,"Unfortunately, she rebuffs us and tells us that we've sent a \"bold ",(0,r.kt)("strong",{parentName:"p"},"REQ"),'uest", and mentions that she would only use a special ',(0,r.kt)("strong",{parentName:"p"},"TYPE")," of language to talk about such secrets. For our last request, we perform the XXE in the ",(0,r.kt)("inlineCode",{parentName:"p"},"reqType")," field:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-xml"},'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE replace [<!ENTITY xxe SYSTEM "file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt" >]>\n    <root>\n      <imgDrop>img1</imgDrop>\n      <who>princess</who>\n      <reqType>&xxe;</reqType>\n    </root>\n')),(0,r.kt)("img",{src:n(5228).Z,style:{width:"1000px"}}),(0,r.kt)("p",null,"Finally trusted by Glamtariel, we walk away victorious with a golden ring filename of ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("inlineCode",{parentName:"strong"},"goldring-morethansupertopsecret76394734.png")),"!"))}c.isMDXComponent=!0},5228:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-11-a31061113ba9690f8a3e036c2a947960.png"},1638:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-6-2265ad52e059894ffefb4a5bbeff680c.png"},8818:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-7-32e6605976becaf492a160e42bbfca5e.png"},7055:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-8-59c0e90fef33e474ca4b599c0b4b52ee.png"},6143:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-9-8542e930c414eb1209e13acd717a9792.png"},8184:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-1-1bff13e02427f9055d12e6d668234827.png"},168:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-2-f03e817121cbf7d310ae4e8fdd60ccf3.png"},2205:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-3-9e09beca56f96d312e5edb511c88a8f3.png"},903:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-4-e2dc23e60a5b346896df6182babdefe8.png"},8085:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/wr8-5-5246eaf28ead483e5d73591253cdf93f.png"}}]);