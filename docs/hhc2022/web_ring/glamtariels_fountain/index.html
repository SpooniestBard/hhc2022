<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-hhc2022/web_ring/glamtariels_fountain">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Glamtariel&#x27;s Fountain | Devan and Kim</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/web_ring/glamtariels_fountain/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Glamtariel&#x27;s Fountain | Devan and Kim"><meta data-rh="true" name="description" content="Background"><meta data-rh="true" property="og:description" content="Background"><link data-rh="true" rel="icon" href="/hhc2022/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/web_ring/glamtariels_fountain/"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/web_ring/glamtariels_fountain/" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/hhc2022/docs/hhc2022/web_ring/glamtariels_fountain/" hreflang="x-default"><link rel="stylesheet" href="/hhc2022/assets/css/styles.5bd81ef5.css">
<link rel="preload" href="/hhc2022/assets/js/runtime~main.21009385.js" as="script">
<link rel="preload" href="/hhc2022/assets/js/main.388b6a01.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/hhc2022/"><div class="navbar__logo"><img src="/hhc2022/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/hhc2022/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Devan and Kim</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/hhc2022/docs/hhc2022/">Holiday Hack Challenge 2022</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/hhc2022/docs/hhc2022/">Holiday Hack Challenge 2022 Write-Up</a><button aria-label="Toggle the collapsible sidebar category &#x27;Holiday Hack Challenge 2022 Write-Up&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/tolkien_ring/">The Tolkien Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Tolkien Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/elfen_ring/">The Elfen Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Elfen Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/">The Web Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Web Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/naughty_ip/">Naughty IP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/credential_mining/">Credential Mining</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/ftw/">404 FTW</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/imds_xxe_abbreviations/">IMDS, XXE, and other Abbreviations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/boria_mine_door/">Open Boria Mine Door</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/hhc2022/docs/hhc2022/web_ring/glamtariels_fountain/">Glamtariel&#x27;s Fountain</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/cloud_ring/">The Cloud Ring</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Cloud Ring&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/hhc2022/docs/hhc2022/burning_ring_of_fire/">The Burning Ring of Fire</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Burning Ring of Fire&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/hhc2022/docs/hhc2022/secrets/">Secrets</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/hhc2022/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hhc2022/docs/hhc2022/"><span itemprop="name">Holiday Hack Challenge 2022 Write-Up</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/hhc2022/docs/hhc2022/web_ring/"><span itemprop="name">The Web Ring</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Glamtariel&#x27;s Fountain</span><meta itemprop="position" content="3"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Glamtariel&#x27;s Fountain</h1><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a class="hash-link" href="#background" title="Direct link to heading">​</a></h3><p>Passing through the Boria Mine door, we&#x27;re brought face to face with <a href="https://glamtarielsfountain.com" target="_blank" rel="noopener noreferrer">Glamtariel and her sentient fountain</a>. Our challenge is to discover something that Glamtariel has never revealed. Is she holding the Web Ring that we&#x27;re seeking?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="challenge">Challenge<a class="hash-link" href="#challenge" title="Direct link to heading">​</a></h3><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Challenge Text</div><div class="admonitionContent_S0QG"><p><em>Difficulty:</em> ★★★★★</p><p>Stare into Glamtariel&#x27;s fountain and see if you can find the ring! What is the filename of the ring she presents you? Talk to Hal Tandybuck in the Web Ring for hints.</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="answer">Answer<a class="hash-link" href="#answer" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="hints-from-glamtariel">Hints from Glamtariel<a class="hash-link" href="#hints-from-glamtariel" title="Direct link to heading">​</a></h4><p>According to Hal Tandybuck, Glamtariel will provide us with  hints by (somehow) speaking to us in upper case letters. During our time speaking to her, she gives us the following hints: <code>TAMPER, PATH, TYPE, RINGLIST, SIMPLE, APP</code></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a class="hash-link" href="#solution" title="Direct link to heading">​</a></h4><p>There are three phases to our interaction with Glamtariel, broken up by the objects that we are able to offer her. During all of the phases, by dropping objects on either the fountain or Glamtariel, they will each reveal their mundane thoughts to us along with a few s3cr3ts.</p><p><img loading="lazy" alt="First phase of interaction with Glamtariel" src="/hhc2022/assets/images/wr8-1-1bff13e02427f9055d12e6d668234827.png" width="1191" height="830" class="img_ev3q"></p><p>By giving Glamtariel and the fountain both the elf and santa objects, we can move on to phase two:</p><p><img loading="lazy" alt="Second phase of interaction with Glamtariel" src="/hhc2022/assets/images/wr8-2-f03e817121cbf7d310ae4e8fdd60ccf3.png" width="1222" height="823" class="img_ev3q"></p><p>Next, by giving the fountain and Glamtariel all of these objects haphazardly (and clicking away a spooky eye along the way), we can advance to the final phase:</p><p><img loading="lazy" alt="Third phase of interaction with Glamtariel" src="/hhc2022/assets/images/wr8-3-9e09beca56f96d312e5edb511c88a8f3.png" width="1110" height="833" class="img_ev3q"></p><p>Now that we&#x27;re here, we&#x27;re able to coax secrets out of Glamtariel. Presenting her with the grey ring has her mention a <strong>RINGLIST</strong> that she makes us promise not to tell anyone about. Dragging the red ring to the fountain makes it mention that Glamtariel can speak in another <strong>TYPE</strong> of language. Unfortunately, we&#x27;ve now exhausted all of the useful information either party will give us through a browser. At this point, we decided to try asking in a different way by taking a peek at the web traffic that we were sending Glamtariel:</p><p><img loading="lazy" alt="Web request to Glamtariel" src="/hhc2022/assets/images/wr8-4-e2dc23e60a5b346896df6182babdefe8.png" width="753" height="533" class="img_ev3q"></p><p>It looks like the data is sent in a simple JSON format. Since <code>reqType</code> is one of the parameters, Glamtariel&#x27;s hint of &quot;<strong>TYPE</strong>&quot;, and the <a href="https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing" target="_blank" rel="noopener noreferrer">XXE</a> hint we received from Hal Tandybuck, implies that we should try to format our request as XML and see what happens:</p><p><img loading="lazy" alt="Web request as XML!" src="/hhc2022/assets/images/wr8-5-5246eaf28ead483e5d73591253cdf93f.png" width="1591" height="663" class="img_ev3q"></p><p>This request works! Glamtariel is clearly well-learned if she can speak such an arcane language. Now that we can ask in XML, we&#x27;ll try to find that ringlist file that Glamtariel mentioned earlier.</p><p>Trying a few strings in the <code>imgDrop</code> field such as <code>ringlist</code>, <code>ringlist.xml</code>, and <code>RINGLIST</code> doesn&#x27;t seem to have any effect - neither the fountain nor Glamtariel have any idea what we&#x27;re talking about. At this point, we&#x27;ll try an XXE for <code>ringlist.txt</code> (<code>.txt</code> since the fountain hints that the list is stored in a <strong>SIMPLE</strong> format). We send the following as our request (also using the <code>/app</code> directory since we need to browse from the filesystem&#x27;s root and <strong>APP</strong> was provided as a hint earlier):</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">replace</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">[</span><span class="token doctype internal-subset" style="color:#999988;font-style:italic">&lt;!ENTITY xxe SYSTEM</span><br></span><span class="token-line" style="color:#393A34"><span class="token doctype internal-subset" style="color:#999988;font-style:italic">&quot;file:///app/static/images/ringlist.txt&quot; &gt;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">]</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token entity named-entity" style="color:#36acaa">&amp;xxe;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">xml</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">princess</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And this works! In Glamtariel&#x27;s response, we&#x27;re given a reference to an image at <code>static/images/pholder-morethantopsupersecret63842.png</code>. Let&#x27;s try going there and seeing what it is:</p><img loading="lazy" src="/hhc2022/assets/images/wr8-6-2265ad52e059894ffefb4a5bbeff680c.png" style="width:300px" class="img_ev3q"><p>The image shows us a folder labeled &quot;x_phial_pholder_2022&quot; which seems to contain two other ring files. Assuming this is indicative of the files/folder structure stored on this webserver, let&#x27;s try our XXE again inside this folder with <code>bluering.txt</code>:</p><img loading="lazy" src="/hhc2022/assets/images/wr8-7-32e6605976becaf492a160e42bbfca5e.png" style="width:1000px" class="img_ev3q"><p>That&#x27;s interesting: it looks like this is the same speech Glamtariel gives us when we manually drop this ring on her in a browser. Although we didn&#x27;t see it in the folder, one of the rings that Glamtariel presented us with earlier was silver. Let&#x27;s try that next:</p><img loading="lazy" src="/hhc2022/assets/images/wr8-8-59c0e90fef33e474ca4b599c0b4b52ee.png" style="width:1000px" class="img_ev3q"><p>When we ask about the silver ring, we&#x27;re also provided with an image of Glamtariel&#x27;s red ring, which has seemingly been defiled. Looking closer at it reveals an etched secret:</p><img loading="lazy" src="/hhc2022/assets/images/wr8-9-8542e930c414eb1209e13acd717a9792.png" style="width:300px" class="img_ev3q"><p>To prevent you from turning your head upside-down, the text on the red ring is <code>goldring_to_be_deleted.txt</code>. With the end almost in sight, we ask Glamtariel about the golden ring:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">replace</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">[</span><span class="token doctype internal-subset" style="color:#999988;font-style:italic">&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot; &gt;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">]</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token entity named-entity" style="color:#36acaa">&amp;xxe;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">princess</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">xml</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Unfortunately, she rebuffs us and tells us that we&#x27;ve sent a &quot;bold <strong>REQ</strong>uest&quot;, and mentions that she would only use a special <strong>TYPE</strong> of language to talk about such secrets. For our last request, we perform the XXE in the <code>reqType</code> field:</p><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">replace</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">[</span><span class="token doctype internal-subset" style="color:#999988;font-style:italic">&lt;!ENTITY xxe SYSTEM &quot;file:///app/static/images/x_phial_pholder_2022/goldring_to_be_deleted.txt&quot; &gt;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">]</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">img1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">imgDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">princess</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">who</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token entity named-entity" style="color:#36acaa">&amp;xxe;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">reqType</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">root</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" src="/hhc2022/assets/images/wr8-11-a31061113ba9690f8a3e036c2a947960.png" style="width:1000px" class="img_ev3q"><p>Finally trusted by Glamtariel, we walk away victorious with a golden ring filename of <strong><code>goldring-morethansupertopsecret76394734.png</code></strong>!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/hhc2022/docs/hhc2022/web_ring/boria_mine_door/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Open Boria Mine Door</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/hhc2022/docs/hhc2022/cloud_ring/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The Cloud Ring</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Devan and Kim</div></div></div></footer></div>
<script src="/hhc2022/assets/js/runtime~main.21009385.js"></script>
<script src="/hhc2022/assets/js/main.388b6a01.js"></script>
</body>
</html>